2023-04-26 21:10:46,907 INFO    ======================================================================
2023-04-26 21:10:46,908 INFO    Survey 252, for Ouro Preto, Minas Gerais
2023-04-26 21:10:46,964 INFO    Searching by bounding box, max_zoom=24
2023-04-26 21:10:46,965 INFO    ----------------------------------------------------------------------
2023-04-26 21:10:46,966 INFO    Rectangle calculated: [-20.2519, -43.4372, -20.5229, -43.7846]
2023-04-26 21:10:46,967 INFO    Searching rectangle: zoom factor = 0, node = []
2023-04-26 21:10:49,622 INFO    Page 01 returned 18 listings
2023-04-26 21:10:49,861 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:10:57,133 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:11:06,021 INFO    Page 02 returned 18 listings
2023-04-26 21:11:09,264 INFO    Page 03 returned 18 listings
2023-04-26 21:11:11,301 INFO    Page 04 returned 18 listings
2023-04-26 21:11:11,833 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:11:21,901 INFO    Page 05 returned 18 listings
2023-04-26 21:11:22,891 INFO    Page 06 returned 18 listings
2023-04-26 21:11:24,910 INFO    Page 07 returned 18 listings
2023-04-26 21:11:25,382 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:11:33,537 INFO    Page 08 returned 18 listings
2023-04-26 21:11:34,854 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:11:43,135 INFO    Page 09 returned 18 listings
2023-04-26 21:11:46,474 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:11:53,725 INFO    Page 10 returned 18 listings
2023-04-26 21:11:58,308 INFO    Page 11 returned 18 listings
2023-04-26 21:12:04,633 INFO    Page 12 returned 18 listings
2023-04-26 21:12:08,399 INFO    Page 13 returned 18 listings
2023-04-26 21:12:10,050 INFO    Page 14 returned 18 listings
2023-04-26 21:12:12,084 INFO    Page 15 returned 18 listings
2023-04-26 21:12:15,181 INFO    Page 16 returned 18 listings
2023-04-26 21:12:15,935 INFO    Page 17 returned 18 listings
2023-04-26 21:12:19,212 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:12:26,476 INFO    Page 18 returned 18 listings
2023-04-26 21:12:30,693 INFO    Page 19 returned 18 listings
2023-04-26 21:12:33,718 INFO    Page 20 returned 18 listings
2023-04-26 21:12:34,826 INFO    Page 21 returned 18 listings
2023-04-26 21:12:38,014 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:12:45,070 INFO    Page 22 returned 18 listings
2023-04-26 21:12:46,787 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:12:59,215 INFO    Page 23 returned 18 listings
2023-04-26 21:13:01,838 INFO    Page 24 returned 18 listings
2023-04-26 21:13:05,554 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:13:14,935 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:13:28,573 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:13:40,491 INFO    Page 25 returned 18 listings
2023-04-26 21:13:45,291 INFO    Page 26 returned 18 listings
2023-04-26 21:13:55,706 INFO    Page 27 returned 18 listings
2023-04-26 21:14:05,059 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:14:17,744 INFO    Page 28 returned 18 listings
2023-04-26 21:14:28,468 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:14:39,863 INFO    Page 29 returned 18 listings
2023-04-26 21:14:43,812 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:14:59,921 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:15:18,111 INFO    Page 30 returned 18 listings
2023-04-26 21:15:24,277 INFO    Page 31 returned 18 listings
2023-04-26 21:15:28,296 INFO    Page 32 returned 18 listings
2023-04-26 21:15:40,258 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:15:53,185 INFO    Page 33 returned 18 listings
2023-04-26 21:15:58,109 INFO    Page 34 returned 18 listings
2023-04-26 21:16:11,864 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:16:35,825 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:16:54,107 INFO    Page 35 returned 18 listings
2023-04-26 21:16:55,836 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:17:15,015 INFO    Page 36 returned 18 listings
2023-04-26 21:17:29,534 INFO    Page 37 returned 18 listings
2023-04-26 21:17:35,424 INFO    Page 38 returned 18 listings
2023-04-26 21:17:55,042 INFO    Page 39 returned 18 listings
2023-04-26 21:17:59,262 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:18:09,921 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:18:21,786 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:18:30,726 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:18:37,180 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:19:02,381 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:19:28,477 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:19:40,416 INFO    Page 40 returned 18 listings
2023-04-26 21:19:59,061 INFO    Page 41 returned 18 listings
2023-04-26 21:20:25,793 INFO    Page 42 returned 18 listings
2023-04-26 21:20:53,315 INFO    Page 43 returned 18 listings
2023-04-26 21:20:53,503 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:21:15,703 INFO    Page 44 returned 18 listings
2023-04-26 21:21:24,538 INFO    Page 45 returned 18 listings
2023-04-26 21:21:39,182 INFO    Page 46 returned 18 listings
2023-04-26 21:21:49,444 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:22:01,917 INFO    Page 47 returned 18 listings
2023-04-26 21:22:10,093 INFO    Page 48 returned 18 listings
2023-04-26 21:22:35,240 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:22:57,597 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:23:07,690 INFO    Page 49 returned 18 listings
2023-04-26 21:23:39,184 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:24:02,969 INFO    Page 50 returned 18 listings
2023-04-26 21:24:02,971 INFO    Results: 50 pages, 296 new rooms
2023-04-26 21:24:03,026 INFO    ----------------------------------------------------------------------
2023-04-26 21:24:03,027 INFO    Rectangle calculated: [-20.2519, -43.4372, -20.3874, -43.6109]
2023-04-26 21:24:03,028 INFO    Searching rectangle: zoom factor = 1, node = [[0, 0]]
2023-04-26 21:24:28,345 INFO    Page 01 returned 18 listings
2023-04-26 21:24:47,826 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:25:27,630 INFO    Page 02 returned 18 listings
2023-04-26 21:25:43,619 INFO    Page 03 returned 18 listings
2023-04-26 21:25:47,092 INFO    Page 04 returned 18 listings
2023-04-26 21:26:04,820 INFO    Page 05 returned 18 listings
2023-04-26 21:26:05,674 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:26:39,314 INFO    Page 06 returned 18 listings
2023-04-26 21:27:06,042 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:27:26,116 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:27:59,827 INFO    Page 07 returned 18 listings
2023-04-26 21:28:07,590 INFO    Page 08 returned 18 listings
2023-04-26 21:28:20,682 INFO    Page 09 returned 18 listings
2023-04-26 21:28:51,949 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:29:22,196 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:30:05,092 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:30:43,643 INFO    Page 10 returned 18 listings
2023-04-26 21:31:09,254 INFO    Page 11 returned 18 listings
2023-04-26 21:31:43,392 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-04-26 21:32:26,363 INFO    Page 12 returned 18 listings
2023-04-26 21:32:44,070 ERROR   Exception in get_search_page_info_rectangle
Traceback (most recent call last):
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 158, in save
    self.__insert()
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 232, in __insert
    cur.execute(sql, insert_args)
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type double precision: "29,766"
LINE 12:                 6, 3, 1.0, '29,766', 0, 2,  -20.38482,  -43....
                                    ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\mono\airbnb-data-collection\airbnb_survey.py", line 809, in search_node
    if listing.save(self.config.FLAGS_INSERT_NO_REPLACE):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 168, in save
    self.config.connection.conn.rollback()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'psycopg2.extensions.connection' object has no attribute 'conn'
2023-04-26 21:32:44,093 ERROR   Error in recurse_quadtree
Traceback (most recent call last):
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 158, in save
    self.__insert()
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 232, in __insert
    cur.execute(sql, insert_args)
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type double precision: "29,766"
LINE 12:                 6, 3, 1.0, '29,766', 0, 2,  -20.38482,  -43....
                                    ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\mono\airbnb-data-collection\airbnb_survey.py", line 525, in recurse_quadtree
    (zoomable, median_leaf) = self.search_node(
                              ^^^^^^^^^^^^^^^^^
  File "C:\mono\airbnb-data-collection\airbnb_survey.py", line 809, in search_node
    if listing.save(self.config.FLAGS_INSERT_NO_REPLACE):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 168, in save
    self.config.connection.conn.rollback()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'psycopg2.extensions.connection' object has no attribute 'conn'
2023-04-26 21:32:44,107 ERROR   Error in recurse_quadtree
Traceback (most recent call last):
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 158, in save
    self.__insert()
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 232, in __insert
    cur.execute(sql, insert_args)
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type double precision: "29,766"
LINE 12:                 6, 3, 1.0, '29,766', 0, 2,  -20.38482,  -43....
                                    ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\mono\airbnb-data-collection\airbnb_survey.py", line 543, in recurse_quadtree
    self.recurse_quadtree(quadtree_node, median_node,
  File "C:\mono\airbnb-data-collection\airbnb_survey.py", line 525, in recurse_quadtree
    (zoomable, median_leaf) = self.search_node(
                              ^^^^^^^^^^^^^^^^^
  File "C:\mono\airbnb-data-collection\airbnb_survey.py", line 809, in search_node
    if listing.save(self.config.FLAGS_INSERT_NO_REPLACE):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 168, in save
    self.config.connection.conn.rollback()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'psycopg2.extensions.connection' object has no attribute 'conn'
2023-04-26 21:32:44,120 ERROR   Error
Traceback (most recent call last):
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 158, in save
    self.__insert()
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 232, in __insert
    cur.execute(sql, insert_args)
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type double precision: "29,766"
LINE 12:                 6, 3, 1.0, '29,766', 0, 2,  -20.38482,  -43....
                                    ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\mono\airbnb-data-collection\airbnb_survey.py", line 463, in search
    self.recurse_quadtree(quadtree_node, median_node, None, flag)
  File "C:\mono\airbnb-data-collection\airbnb_survey.py", line 543, in recurse_quadtree
    self.recurse_quadtree(quadtree_node, median_node,
  File "C:\mono\airbnb-data-collection\airbnb_survey.py", line 525, in recurse_quadtree
    (zoomable, median_leaf) = self.search_node(
                              ^^^^^^^^^^^^^^^^^
  File "C:\mono\airbnb-data-collection\airbnb_survey.py", line 809, in search_node
    if listing.save(self.config.FLAGS_INSERT_NO_REPLACE):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 168, in save
    self.config.connection.conn.rollback()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'psycopg2.extensions.connection' object has no attribute 'conn'
2023-04-26 21:32:44,128 ERROR   Top level exception handler: quitting.
Traceback (most recent call last):
  File "C:\mono\airbnb-data-collection\search.py", line 272, in main
    select_command(config,
        ^^^^^^^^^^^^^^^^^^^
  File "C:\mono\airbnb-data-collection\search.py", line 215, in full_process
    group.add_argument('-psz', '--printsearch_by_zipcode',
                         ^^^^^^^^^^^^^^^^^^^^^^
TypeError: select_sublocalities() missing 2 required positional arguments: 'config' and 'city'
