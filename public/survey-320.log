2023-05-05 18:08:48,664 INFO    ======================================================================
2023-05-05 18:08:48,665 INFO    Survey 320, for Ouro Preto, Minas Gerais
2023-05-05 18:08:48,666 INFO    Searching by bounding box, max_zoom=24
2023-05-05 18:08:48,667 INFO    ----------------------------------------------------------------------
2023-05-05 18:08:48,668 INFO    Rectangle calculated: [-20.2519, -43.4372, -20.5229, -43.7846]
2023-05-05 18:08:48,669 INFO    Searching rectangle: zoom factor = 0, node = []
2023-05-05 18:09:03,676 INFO    Page 01 returned 18 listings
2023-05-05 18:09:17,091 INFO    Page 02 returned 18 listings
2023-05-05 18:09:30,233 INFO    Page 03 returned 18 listings
2023-05-05 18:09:30,654 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:09:37,519 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:09:57,503 INFO    Page 04 returned 18 listings
2023-05-05 18:10:12,172 INFO    Page 05 returned 18 listings
2023-05-05 18:10:12,404 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:10:33,007 INFO    Page 06 returned 18 listings
2023-05-05 18:10:33,888 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:10:55,880 INFO    Page 07 returned 18 listings
2023-05-05 18:11:12,623 INFO    Page 08 returned 18 listings
2023-05-05 18:11:27,172 INFO    Page 09 returned 18 listings
2023-05-05 18:11:29,966 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:11:50,658 INFO    Page 10 returned 18 listings
2023-05-05 18:12:07,455 INFO    Page 11 returned 18 listings
2023-05-05 18:12:11,177 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:12:18,222 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:12:37,462 INFO    Page 12 returned 18 listings
2023-05-05 18:12:40,424 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:12:53,337 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:13:16,236 INFO    Page 13 returned 18 listings
2023-05-05 18:13:24,021 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:13:48,603 INFO    Page 14 returned 18 listings
2023-05-05 18:14:12,104 INFO    Page 15 returned 18 listings
2023-05-05 18:14:13,937 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:14:31,245 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:14:44,327 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:15:15,016 INFO    Page 16 returned 18 listings
2023-05-05 18:15:25,668 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:15:52,912 INFO    Page 17 returned 18 listings
2023-05-05 18:16:05,113 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:16:29,268 INFO    Page 18 returned 18 listings
2023-05-05 18:16:51,714 INFO    Page 19 returned 18 listings
2023-05-05 18:16:57,708 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:17:17,627 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:17:44,871 INFO    Page 20 returned 18 listings
2023-05-05 18:17:49,907 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:18:20,603 INFO    Page 21 returned 18 listings
2023-05-05 18:18:31,518 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:18:53,000 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:19:13,819 INFO    Page 22 returned 18 listings
2023-05-05 18:19:42,351 INFO    Page 23 returned 18 listings
2023-05-05 18:20:08,501 INFO    Page 24 returned 18 listings
2023-05-05 18:20:21,261 INFO    Page 25 returned 18 listings
2023-05-05 18:20:48,023 INFO    Page 26 returned 18 listings
2023-05-05 18:21:01,767 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:21:22,081 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:22:01,052 INFO    Page 27 returned 18 listings
2023-05-05 18:22:18,879 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:22:43,303 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:23:07,696 INFO    Page 28 returned 18 listings
2023-05-05 18:23:23,463 INFO    Page 29 returned 18 listings
2023-05-05 18:23:44,702 INFO    Page 30 returned 18 listings
2023-05-05 18:24:07,659 INFO    Page 31 returned 18 listings
2023-05-05 18:24:27,724 INFO    Page 32 returned 18 listings
2023-05-05 18:24:48,525 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:25:15,906 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:25:24,007 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:26:06,183 INFO    Page 33 returned 18 listings
2023-05-05 18:26:29,346 INFO    Page 34 returned 18 listings
2023-05-05 18:26:46,409 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:27:29,865 INFO    Page 35 returned 18 listings
2023-05-05 18:27:51,356 INFO    Page 36 returned 18 listings
2023-05-05 18:28:18,179 INFO    Page 37 returned 18 listings
2023-05-05 18:28:24,346 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:28:55,482 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:29:45,458 INFO    Page 38 returned 18 listings
2023-05-05 18:30:10,373 INFO    Page 39 returned 18 listings
2023-05-05 18:30:40,238 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:31:00,813 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:31:34,114 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:31:58,987 INFO    Page 40 returned 18 listings
2023-05-05 18:32:26,862 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:33:06,970 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:33:42,523 INFO    Page 41 returned 18 listings
2023-05-05 18:34:14,322 INFO    Page 42 returned 18 listings
2023-05-05 18:34:41,973 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:35:32,684 INFO    Page 43 returned 18 listings
2023-05-05 18:36:11,319 INFO    Page 44 returned 18 listings
2023-05-05 18:36:41,444 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:37:19,323 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:37:41,737 INFO    Page 45 returned 18 listings
2023-05-05 18:38:18,582 INFO    Page 46 returned 18 listings
2023-05-05 18:38:36,382 INFO    Page 47 returned 18 listings
2023-05-05 18:38:53,947 INFO    Page 48 returned 18 listings
2023-05-05 18:39:31,624 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:40:16,035 INFO    Page 49 returned 18 listings
2023-05-05 18:40:46,778 INFO    Page 50 returned 18 listings
2023-05-05 18:40:46,778 INFO    Results: 50 pages, 295 new rooms
2023-05-05 18:40:46,781 INFO    ----------------------------------------------------------------------
2023-05-05 18:40:46,781 INFO    Rectangle calculated: [-20.2519, -43.4372, -20.3874, -43.6109]
2023-05-05 18:40:46,782 INFO    Searching rectangle: zoom factor = 1, node = [[0, 0]]
2023-05-05 18:41:21,932 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:42:10,147 INFO    Page 01 returned 18 listings
2023-05-05 18:42:27,558 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:43:01,289 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:43:37,947 INFO    Page 02 returned 18 listings
2023-05-05 18:44:10,157 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:44:47,127 INFO    Page 03 returned 18 listings
2023-05-05 18:45:11,993 INFO    Page 04 returned 18 listings
2023-05-05 18:46:04,089 INFO    Page 05 returned 18 listings
2023-05-05 18:46:41,229 INFO    Page 06 returned 18 listings
2023-05-05 18:47:28,590 INFO    Page 07 returned 18 listings
2023-05-05 18:47:55,530 INFO    Page 08 returned 18 listings
2023-05-05 18:48:16,980 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:48:39,067 INFO    Page 09 returned 18 listings
2023-05-05 18:49:02,367 INFO    Page 10 returned 18 listings
2023-05-05 18:49:36,008 INFO    Page 11 returned 18 listings
2023-05-05 18:50:14,190 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:50:40,329 INFO    Page 12 returned 18 listings
2023-05-05 18:51:00,912 INFO    Page 13 returned 18 listings
2023-05-05 18:51:04,253 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:51:12,243 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:51:23,784 WARNING HTTP status 403 from web site: IP address blocked. Waiting 0.1 minutes.
2023-05-05 18:52:04,919 INFO    Page 14 returned 18 listings
2023-05-05 18:52:27,819 ERROR   Exception in get_search_page_info_rectangle
Traceback (most recent call last):
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 161, in save
    self.__insert()
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 236, in __insert
    cur.execute(sql, insert_args)
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type double precision: "30,104"
LINE 12:                 6, 3, 1.0, '30,104', 0, 2,  -20.38482,  -43....
                                    ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\mono\airbnb-data-collection\airbnb_survey.py", line 809, in search_node
    if listing.save(self.config.FLAGS_INSERT_NO_REPLACE):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 171, in save
    self.config.connection.conn.rollback()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'psycopg2.extensions.connection' object has no attribute 'conn'
2023-05-05 18:52:27,825 ERROR   Error in recurse_quadtree
Traceback (most recent call last):
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 161, in save
    self.__insert()
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 236, in __insert
    cur.execute(sql, insert_args)
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type double precision: "30,104"
LINE 12:                 6, 3, 1.0, '30,104', 0, 2,  -20.38482,  -43....
                                    ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\mono\airbnb-data-collection\airbnb_survey.py", line 525, in recurse_quadtree
    (zoomable, median_leaf) = self.search_node(
                              ^^^^^^^^^^^^^^^^^
  File "C:\mono\airbnb-data-collection\airbnb_survey.py", line 809, in search_node
    if listing.save(self.config.FLAGS_INSERT_NO_REPLACE):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 171, in save
    self.config.connection.conn.rollback()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'psycopg2.extensions.connection' object has no attribute 'conn'
2023-05-05 18:52:27,830 ERROR   Error in recurse_quadtree
Traceback (most recent call last):
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 161, in save
    self.__insert()
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 236, in __insert
    cur.execute(sql, insert_args)
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type double precision: "30,104"
LINE 12:                 6, 3, 1.0, '30,104', 0, 2,  -20.38482,  -43....
                                    ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\mono\airbnb-data-collection\airbnb_survey.py", line 543, in recurse_quadtree
    self.recurse_quadtree(quadtree_node, median_node,
  File "C:\mono\airbnb-data-collection\airbnb_survey.py", line 525, in recurse_quadtree
    (zoomable, median_leaf) = self.search_node(
                              ^^^^^^^^^^^^^^^^^
  File "C:\mono\airbnb-data-collection\airbnb_survey.py", line 809, in search_node
    if listing.save(self.config.FLAGS_INSERT_NO_REPLACE):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 171, in save
    self.config.connection.conn.rollback()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'psycopg2.extensions.connection' object has no attribute 'conn'
2023-05-05 18:52:27,836 ERROR   Error
Traceback (most recent call last):
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 161, in save
    self.__insert()
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 236, in __insert
    cur.execute(sql, insert_args)
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type double precision: "30,104"
LINE 12:                 6, 3, 1.0, '30,104', 0, 2,  -20.38482,  -43....
                                    ^


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\mono\airbnb-data-collection\airbnb_survey.py", line 463, in search
    self.recurse_quadtree(quadtree_node, median_node, None, flag)
  File "C:\mono\airbnb-data-collection\airbnb_survey.py", line 543, in recurse_quadtree
    self.recurse_quadtree(quadtree_node, median_node,
  File "C:\mono\airbnb-data-collection\airbnb_survey.py", line 525, in recurse_quadtree
    (zoomable, median_leaf) = self.search_node(
                              ^^^^^^^^^^^^^^^^^
  File "C:\mono\airbnb-data-collection\airbnb_survey.py", line 809, in search_node
    if listing.save(self.config.FLAGS_INSERT_NO_REPLACE):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\mono\airbnb-data-collection\airbnb_listing.py", line 171, in save
    self.config.connection.conn.rollback()
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'psycopg2.extensions.connection' object has no attribute 'conn'
2023-05-05 18:52:27,843 INFO    Initialing search by overall satisfactions
2023-05-05 18:52:27,896 ERROR   Failed to search overall satisfactions
2023-05-05 18:52:27,897 ERROR   Top level exception handler: quitting.
Traceback (most recent call last):
  File "C:\mono\airbnb-data-collection\search.py", line 363, in main
    search_routes(ab_config, args.search_routes, fill_airbnb_with_selenium=True)
  File "C:\mono\airbnb-data-collection\search.py", line 244, in full_process
    survey_id = execute_search(config, _platform, search_area_name, fill_bnb_with_selenium, start_date, finish_date, super_survey_id)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\mono\airbnb-data-collection\search.py", line 217, in execute_search
    airbnb_score_search(ab_config, search_area_name, 252, None)
  File "C:\mono\airbnb-data-collection\airbnb_score.py", line 215, in airbnb_score_search
    logging.info("Attempt " + str(i+1) + " to find room " + room_id)
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~
TypeError: can only concatenate str (not "int") to str
